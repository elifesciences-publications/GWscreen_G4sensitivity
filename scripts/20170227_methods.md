
This is a draft of the Analysis section of the shRNA paper:

The code and scripts will all be hosted in a group's github page, which I will create soon (the link could go somewhere around here).

## Analysis

- Read processing, alignment and counting of shRNAs
The DNA-seq libraries corresponding to each pool, timepoint and chemical treatment were prepared using the ??? library preparation kit, followed by 36 base pair single-read sequencing performed on an Illumina NextSeq instrument. Reads were trimmed to 22 nucleotides, base qualities were evaluated with FastQC v0.11.3 [Andrews2010] and bases were filtered from the 3' end with a Phred quality threshold of 33 using the FASTX-Toolkit v0.0.14 [Gordon2010]. Trimmed reads were aligned to the 113002 reference shRNA sequences provided by transOMIC technologies [Knott2014] using Bowtie 2 v2.2.6 with default parameters [Langmead2012], which resulted in overall alignment rates of 90-95% with an average of 98% of reference sequences detected. The generated SAM files were processed to obtain shRNA counts using Unix tools and Python scripts, and library purity and potential contaminations were investigated with stacked bar plots and multidimensional scaling (MDS) using the R programming language [link to github page].

- Filtering, normalisation and differential representation analysis
To discard shRNAs bearing low counts, each library was filtered based on a counts-per-million threshold of 0.5 for all initial timepoints (t0), e.g. in a library of 10M reads, shRNAs with at least 5 counts for all initial timepoints will pass this filter. Normalisation factors were calculated to scale the raw library sizes using the weighted trimmed mean of M-values (TMM) [Robinson and Oshlack 2010]. In order to compare groups of replicates (timepoints and chemical treatments) for each pool, differential representation analysis of shRNA counts was performed using edgeR [Robinson, McCarthy and Smyth 2010]. Common and shRNA-specific dispersions were estimated to allow the fitting of a negative binomial generalised linear model (glm) to the treatment counts. Contrasts between the initial timepoint and the treatments were defined (PDS-t0, PhenDC3-t0, and DMSO-t0) and likelihood ratio tests were carried out accordingly [Dai2014]. Fold changes (FC) were then computed for every shRNA, and false discovery rates (FDR) were estimated using the Benjamini-Hochberg method.

- Integration, thresholding and visualisation
Results for all pools were combined into three tables according to the contrasts. In order to optimise knock-down efficiency, the screen was executed so that several shRNAs target a given gene. Genes were then further selected if at least 50% or a minimum of 3 shRNAs resulted significant based on a FDR<=0.05. From the reference list of 18937 genes, 1247 were found to be sensitisers (FC < 1). The overlap between the sets of chosen genes corresponding to each contrast were then explored and visualise using several R scripts [link to github page].
